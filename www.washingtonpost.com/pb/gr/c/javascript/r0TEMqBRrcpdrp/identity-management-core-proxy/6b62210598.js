(function($){TWP.Util=TWP.Util||{};TWP.Util.User=function(){var initialized=false;var isAuthenticated=false;var userName=null;var userId="";var userEmail="";var userCookie=null;var isFacebookUser=false;var userType="washington-post";var validCookies=["wapo_display"];var authCookies=["wapo_login_id"];var emailCookie=["at"];function parseCookieUserName(cookie,startStr){if(cookie===null||cookie.length===0)return"";var start=-1,end=-1;start=cookie.indexOf(startStr)+startStr.length+1;end=userCookie.indexOf(";",
start)==-1?userCookie.length:userCookie.indexOf(";",start);var userData=cookie.substring(start,end).split("|");var parsedName="";if(userData[3])parsedName=userData[3].replace(/\+/g," ");else if(userData[2]&&userData[2].indexOf("rw%3D")==-1)parsedName=userData[2].replace(/\+/g," ");else parsedName=userData[0];return parsedName}function parseCookieEmail(){var i,x,y,ARRcookies=document.cookie.split(";");for(i=0;i<ARRcookies.length;i++){var x=ARRcookies[i].substr(0,ARRcookies[i].indexOf("\x3d"));var y=
ARRcookies[i].substr(ARRcookies[i].indexOf("\x3d")+1);var x=x.replace(/^\s+|\s+$/g,"");if(x=="at"){var string=unescape(y);var email=string.split("\x3d")[3];var isValidEmail=false;if(email){email=email.split("\x26")[0];if(email)var isValidEmail=validateEmail(email);else return isValidEmail}else return isValidEmail;return email.length>0&&typeof email=="string"&&isValidEmail?email:false}}}function validateEmail(str){var atpos=str.indexOf("@");var dotpos=str.lastIndexOf(".");if(atpos<1||dotpos<atpos+
2||dotpos+2>=str.length)return false;else return true}function setCustomCookie(){var upcUrl=document.location.href;if(upcUrl.indexOf("localhost")>-1){var c=$.cookie("TWPNIUCID");if(typeof c=="undefined"||c==null){var d=new Date;var i="TWPNI"+d.getTime()+"."+Math.round(Math.random()*1E4);d.setTime(d.getTime()+31104E6);$.cookie("TWPNIUCID",i,{domain:TWP.Data.cookie_domain,expires:d,path:"/"})}}if(upcUrl.indexOf("beta")>-1){var c=$.cookie("x-split-override");if(c==null||typeof c=="undefined"){var d=
new Date;d.setTime(d.getTime()+1E3*60*60*24*30);$.cookie("x-split-override","B",{domain:TWP.Data.cookie_domain,expires:d,path:"/"});$.cookie("X-WP-Split","B",{domain:TWP.Data.cookie_domain,expires:d,path:"/"})}}}function convertPersistentToSessionCookie(){var xsplitoverride=$.cookie("x-split-override");if(typeof xsplitoverride!="undefined"&&xsplitoverride!=null){$.cookie("x-split-override",null,{domain:TWP.Data.cookie_domain,path:"/"});$.cookie("x-split-override",xsplitoverride,{domain:TWP.Data.cookie_domain,
path:"/"})}var xwpslit=$.cookie("X-WP-Split");if(typeof xwpslit!="undefined"&&xwpslit!=null){$.cookie("X-WP-Split",null,{domain:TWP.Data.cookie_domain,path:"/"});$.cookie("X-WP-Split",xwpslit,{domain:TWP.Data.cookie_domain,path:"/"})}}return{init:function(){var userCookieName="";for(var a=0;a<authCookies.length;a++)if(document.cookie.indexOf(authCookies[a])!=-1){isAuthenticated=true;break}for(var a=0;a<validCookies.length;a++)if(document.cookie.indexOf(validCookies[a])!=-1){userCookie=document.cookie;
userType=validCookies[a];break}if(isAuthenticated){switch(userType){case "fbuname":userCookieName=parseCookieUserName(userCookie,userType,8);break;default:userCookieName=parseCookieUserName(userCookie,userType,9);break}userCookieName=decodeURIComponent(userCookieName);userName=userCookieName.indexOf("@")!==-1?userCookieName.substring(0,userCookieName.indexOf("@")):userCookieName;userName=userName.replace(/"/gi,"");userId=userCookieName;userEmail=parseCookieEmail()}setCustomCookie()},getUserCookie:function(){return userCookie.length>
0&&typeof userCookie=="string"?userCookie:null},getUserType:function(){return userType.length>0&&typeof userType=="string"?userType:null},getUserId:function(){return userId},getUserName:function(){return typeof userName=="string"?userName:""},getUserEmail:function(){return userEmail.length<0||userEmail==false?null:userEmail},getAuthentication:function(){return isAuthenticated}}}();TWP.Util.User.init()})(window.Zepto||window.jQuery);
(function($){console.log("TWP.Identity");__e=window.__e||[];window.TWP=window.TWP||{};TWP.Identity=TWP.Identity||{};TWP.Identity.paywall=TWP.Identity.paywall||{};TWP.Identity.paywall.requireTracking=true;TWP.server=TWP.server||window.location.href.match(/^.*?:\/\/.*?\//)[0];var currDomain=TWP.Data&&TWP.Data.environment=="prod"||TWP.Data.environment=="stage"?".washingtonpost.com":".digitalink.com";var currDocDomain=TWP.Data&&TWP.Data.environment=="prod"||TWP.Data.environment=="stage"?"washingtonpost.com":
"digitalink.com";var actmgmtCookie="wapo_actmgmt";var gmeCookie="wapo_gme";var isPWA=!!TWP.PWA;var isMobile=isPWA||typeof mobile_browser!="undefined"&&mobile_browser===1?true:false;var tidValues={main:"sub_s004",home:"s_001",digital:"s_002",gift:"s_003"};var _qaEnvironment=window.location.host.indexOf("digitalink.com")!=-1;var expireTime,wapo_gme;var bottomAdClosed,wallClosed;var setPerPageVars=function(){var d=new Date;expireTime=d.setHours(d.getHours()+24);wapo_gme=$.cookie(gmeCookie);TWP.Identity.env=
{expireTime:expireTime,currDomain:currDomain,_qaEnvironment:_qaEnvironment,actmgmtCookie:actmgmtCookie}};window.setCookie=function(name,value,options){options=options||{};if(value===null){value="";options=$.extend({},options);options.expires=-1}var expires="";if(options.expires&&(typeof options.expires=="number"||options.expires.toUTCString)){var date;if(typeof options.expires=="number"){date=new Date;date.setTime(date.getTime()+options.expires*24*60*60*1E3)}else date=options.expires;expires="; expires\x3d"+
date.toUTCString()}var path=options.path?"; path\x3d"+options.path:"";var domain=options.domain?"; domain\x3d"+options.domain:"";var secure=options.secure?"; secure":"";document.cookie=[name,"\x3d",value,expires,path,domain,secure].join("")};var _scrollHandler=function(){return false};function toggleScrolling(scroll){var height=scroll?"":"100%";var overflow=scroll?"":"hidden";$("body,html").css({height:height,overflow:overflow});if(scroll)$(document).unbind("touchmove touchend mousewheel mousemove scroll",
_scrollHandler);else $(document).bind("touchmove touchend mousewheel mousemove scroll",_scrollHandler)}function getOverlay(action){var overlay={overlay:'\x3cdiv id\x3d"wp_Signin" class\x3d"simple-overlay closed '+(action===6?"softwall":"content_gate")+(isPWA?" is-pwa":"")+'" style\x3d"overflow: hidden;"\x3e'+(action!==6?'\x3cdiv class\x3d"wall_background" style\x3d"background-color:black;height:100%;width:100%;opacity:0.5;"\x3e\x3c/div\x3e':"")+(action===3?'\x3ciframe id\x3d"wallIframe" style\x3d"position:absolute;top:0;" src class\x3d"':
'\x3ciframe id\x3d"wallIframe" style\x3d"position:fixed;bottom:0;" src class\x3d"')+(isPWA?"is-pwa":"")+'" height\x3d"100%" width\x3d"100%;" scrolling\x3d"'+(isPWA?"yes":"auto")+'" frameborder\x3d"0"\x3e\x3c/iframe\x3e\x3c/div\x3e',overlayConfig:{overlay:75,overlayClass:"wp_signin closed "+(action===6?"softwall":"content_gate")+(isPWA?" is-pwa":""),modal:action===6?false:true,closeClassxxx:"close",toTop:true,triggerxxx:".close",bodyClass:"pw-display",onShow:function(h){$(window).scrollTop(0);h.w.prependTo(h.o);
if($(".pb-f-page-header-v2 .site-header.bar-hidden").length>0)$(".pb-f-page-header-v2 .site-header").removeClass("bar-hidden");var zIndexOverlay=parseFloat($(".pb-f-page-breaking-news-bar .breaking-news-bar").css("z-index"))+1;zIndexOverlay=action===6?134217720:zIndexOverlay;h.o.css("z-index",zIndexOverlay);h.w.css("z-index",zIndexOverlay+1);h.o.prependTo("body")},onHide:function(h){if($(arguments[0].target).is(".close"))window.location.href="/";toggleScrolling(true);if(!!window.s&&typeof s.sendDataToOmniture==
"function"){var closeVars={eVar1:s.pageName,eVar2:s.channel,eVar5:s.prop3};try{s.sendDataToOmniture("close overlay","event63",closeVars)}catch(e){}}h.w.hide()&&h.o&&h.o.remove();return true}}};var setCss=function(messagePayload){var cssArray=["top","height","bottom","position","left","right","background","display"];var styles={};for(var i=0;i<cssArray.length;i++)if(messagePayload[cssArray[i]])styles[cssArray[i]]=messagePayload[cssArray[i]];return styles};var calcTop=function(topPos,elementSelector){if(elementSelector)try{var domElement=
document.querySelector(elementSelector);if(domElement){var offsetTop=domElement.getBoundingClientRect().top+window.pageYOffset;return parseInt(topPos,10)+offsetTop}}catch(err){return topPos}else return topPos};var messageListener=function(messageData,h){if(typeof messageData.data==="string")if(messageData.data.indexOf("wallAction")>-1){var messagePayload={};try{messagePayload=JSON.parse(messageData.data)}catch(ex){return}var defaultConfig={top:"60px",bottom:"0",position:"absolute",left:"0",scrollAllowed:false};
var wallAction=messagePayload.wallAction;var wallType=messagePayload.wallType;messagePayload=$.extend(defaultConfig,messagePayload);var $body=$("body");switch(wallAction){case "open":if(messagePayload.scrollAllowed)toggleScrolling(true);else{toggleScrolling(false);$body.addClass(h&&h.c&&h.c.bodyClass||"")}_showLimitedContent(wallType);var $signInIframeWrapper=$("#wp_Signin");var $overlayWrapper=$(".wp_signin");$overlayWrapper.css({display:"none"});if(messagePayload.background){var $wallBackground=
$(".wall_background");$wallBackground.css({background:messagePayload.background})}messagePayload.top=calcTop(messagePayload.top,messagePayload.element);messagePayload.display="block";$(".wp_signin, #wp_Signin").removeClass("closed");$signInIframeWrapper.css(setCss(messagePayload));break;case "close":wallClosed=true;h.w.jqmHide();$body.removeClass(h&&h.c&&h.c.bodyClass||"");$(".wp_signin").css("display","none");window.removeEventListener("message",function(){messageListener(event,h)});break;case "resize":var messageHeight=
messagePayload.height;var resizeHeight=typeof messageHeight==="number"?messageHeight+"px":messageHeight;if(messagePayload.height)h.w.find("iframe").css("height",resizeHeight);break;case "requestGADataLayer":var wallGADataObj=(window.dataLayer||[]).filter(function(layer){return layer.pageName||layer.canonicalUrl||layer.userAgentHit})[0];wallGADataObj=wallGADataObj||{};wallGADataObj.wallAction="GAdataLayer";var iframeWindow=document.getElementById("wallIframe").contentWindow;iframeWindow.postMessage(JSON.stringify(wallGADataObj),
"*");break;case "CompleteRegwall":break;case "regAuthenticated":document.querySelector("div.wall_background").style="opacity:0;";break;default:}}};if(action==3||action==8||action==6||action==9){var onShowDefault=overlay.overlayConfig.onShow;overlay.overlayConfig.onShow=function(h){onShowDefault(h);window.addEventListener("message",function(){messageListener(event,h)})};return overlay}else return false}TWP.Identity.omniture={sub:{"-1":"N/A",0:"Unsubscribed",1:"Subscribed"},mtr:{"-1":"Unmetered",1:"Metered",
20:"Unmetered: content_type",21:"Unmetered: referer",22:"Unmetered: domain"},tracking:{wp_evar60:"not available",wp_evar64:"not available",wp_evar65:"not available",wp_evar66:"not available"},overlay:{3:"meter-overlay",6:"dismissible-overlay",8:"content-overlay",9:"reg-overlay"}};TWP.isSignedIn=function(){var cookies=document.cookie;var idx=cookies.indexOf("wapo_login_id");if(idx>-1)return true;else return false};TWP.Identity.setAuthenticationLinkForPWA=function(){$.fn.appendLinkItems=function(links,
surroundingTag){var element=this;surroundingTag=surroundingTag||"\x3cli\x3e";$.each(links,function(i,link){var a=$("\x3ca\x3e");if(link.title)a.text(link.title);if(link.html)a.html(link.html);if(link.href)a.attr("href",link.href);if(link.attr)a.attr(link.attr);element.append($(surroundingTag).append(a).addClass(link.selected?"selected":""))});return this};var idenity={},idp;idenity.getIdentityProvider=function(){return idp};idenity.setIdentityMenu=function($el,menu){$el.children("li").remove();$el.appendLinkItems(menu)};
idenity.setIdentityProvider=function(provider){var ef=function(){};idp={};idp.name=provider.name||"";idp.getUserId=provider.getUserId||ef;idp.getProfileMenu=provider.getProfileMenu||ef;idp.getSubscribeMenu=provider.getSubscribeMenu||ef;idp.getLogOutMenu=provider.getLogOutMenu||ef;idp.getSignInMenu=provider.getSignInMenu||ef;idp.getSignInLink=provider.getSignInLink||ef;idp.getRegistrationLink=provider.getRegistrationLink||ef;idp.isUserLoggedIn=provider.isUserLoggedIn||ef;idp.userMenu=[];idp.render=
provider.render||function(){var $identityEl=$("#logged-in-status");if(idp.isUserLoggedIn()){idp.userMenu.push(idp.getProfileMenu());if(!wp_pb.StaticMethods.isSubscriber())idp.userMenu.push(idp.getSubscribeMenu());idp.userMenu.push(idp.getLogOutMenu())}else{idp.userMenu.push(idp.getSignInMenu());idp.userMenu.push(idp.getSubscribeMenu())}idenity.setIdentityMenu($identityEl,idp.userMenu)}};idenity.renderIdentity=function(callback){callback=callback||function(){};if(idp)idp.render();callback(idp)};var showIdentity=
true;var current=window.location.href.split("?")[0];var twpIdentity={name:"TWP",getUserId:function(){var username=TWP.Util.User.getUserName();var userid=TWP.Util.User.getUserId();if(typeof username=="string"&&username.length>0)return username;else return userid},getProfileMenu:function(){return{title:"Profile",href:TWP.signin.profileurl+current+"\x26refresh\x3dtrue"}},getSubscribeMenu:function(){return{title:"Subscribe",href:TWP.signin.subscribe}},getLogOutMenu:function(){return{title:"Log out",href:TWP.signin.logouturl_page}},
getSignInMenu:function(){return{title:"Sign In",href:TWP.signin.loginurl_page+current}},getSignInLink:function(){return TWP.signin.loginurl_page+current},getRegistrationLink:function(){return TWP.signin.registrationurl_page+current},isUserLoggedIn:function(){return TWP.Util.User?TWP.Util.User.getAuthentication():false}};if(showIdentity)(function checkTWP(){if(!idenity.getIdentityProvider())if(!!window.TWP&&!!TWP.signin&&!!TWP.Util){idenity.setIdentityProvider(twpIdentity);idenity.renderIdentity()}else window.setTimeout(function(){checkTWP()},
200)})()};TWP.Identity.setAuthenticationLink=function(data){if(typeof data=="object")$.extend(TWP.Identity.paywall.pwresp,data.pwresp);if(TWP.server.match(/digitalink\.com|washingtonpost\.com|wpprivate\.com/gi)==null)return;var wrapperElm=$("#utility-wrapper");if(isPWA){TWP.Identity.setAuthenticationLinkForPWA();return}else if(wrapperElm.length<=0)return;var userName="";var provider="";var currentURL=window.location.href.split("?")[0];TWP.Identity.isSignedIn=TWP.Util.User.getAuthentication();if(TWP.Identity.isSignedIn){userName=
TWP.Util.User.getUserName();provider=typeof TWP.signedInProvider=="function"?TWP.signedInProvider():"Washington Post";provider=typeof provider!="undefined"?provider.toLowerCase():""}var freeAccessLink=TWP.Identity.paywall.pwresp.fr===1?'\x3cli class\x3d"no-right"\x3e'+'\x3ca href\x3d"'+TWP.signin.free_access+'"\x3eGET FREE ACCESS\x3c/a\x3e'+"\x3c/li\x3e":"";var signinLinks={pw:{anon:'\x3cli id\x3d"global-signin"style\x3d"min-width:32px;"\x3e'+'\x3ca href\x3d"'+TWP.signin.loginurl_page+currentURL+
'"\x3eSign In\x3c/a\x3e'+"\x3c/li\x3e"+'\x3cli class\x3d"no-right"\x3e\x3ca href\x3d"'+TWP.signin.profileurl+currentURL+'\x26refresh\x3dtrue"\x3eMy Account \x3c/a\x3e\x3c/li\x3e'+freeAccessLink+'\x3cul class\x3d"subscribe-links left"\x3e'+'\x3cli class\x3d"no-right subscribe"\x3e\x3ca href\x3d"'+TWP.signin.subscribe+"?tid\x3d"+tidValues.main+'\x26promo\x3ddigital04_header_default\x26oscode\x3dRPWH\x26wpsrc\x3dCM0000447\x26show4\x3dtrue"\x3eSUBSCRIBE: \x3c/a\x3e\x3c/li\x3e'+'\x3cli \x3e\x3ca href\x3d"'+
TWP.signin.print_offer+"tid\x3d"+tidValues.home+'\x26promo\x3ddigital06_header_homedelivery\x26oscode\x3dRPWH\x26wpsrc\x3dCM0000450"\x3eHome Delivery\x3c/a\x3e\x3c/li\x3e'+'\x3cli class\x3d"no-right"\x3e\x3ca href\x3d"'+TWP.signin.digital_offer+"tid\x3d"+tidValues.digital+'\x26promo\x3ddigital04_header_default\x26oscode\x3dRPWH\x26wpsrc\x3dCM0000447"\x3eDigital\x3c/a\x3e\x3c/li\x3e'+"\x3c/ul\x3e",0:"\x3cli\x3e"+(provider.indexOf("facebook")>=0?'\x3ca class\x3d"icon share facebook" ':"\x3ca ")+' href\x3d"'+
TWP.signin.profileurl+currentURL+'\x26refresh\x3dtrue"\x3e Hi, '+userName+"!\x3c/a\x3e"+"\x3c/li\x3e"+'\x3cli\x3e\x3ca href\x3d"'+TWP.signin.profileurl+currentURL+'\x26refresh\x3dtrue"\x3eMy Account \x3c/a\x3e\x3c/li\x3e'+'\x3cli class\x3d"no-right"\x3e\x3ca href\x3d"'+TWP.signin.logouturl_page+'"\x3eSign Out\x3c/a\x3e\x3c/li\x3e'+freeAccessLink+'\x3cul class\x3d"subscribe-links left"\x3e'+'\x3cli class\x3d"no-right subscribe"\x3e\x3ca href\x3d"'+TWP.signin.subscribe+"?tid\x3d"+tidValues.main+'\x26promo\x3ddigital04_header_default\x26oscode\x3dRPWH\x26wpsrc\x3dCM0000447\x26show4\x3dtrue"\x3eSUBSCRIBE: \x3c/a\x3e\x3c/li\x3e'+
'\x3cli \x3e\x3ca href\x3d"'+TWP.signin.print_offer+"tid\x3d"+tidValues.home+'\x26promo\x3ddigital06_header_homedelivery\x26oscode\x3dRPWH\x26wpsrc\x3dCM0000450"\x3eHome Delivery\x3c/a\x3e\x3c/li\x3e'+'\x3cli class\x3d"no-right"\x3e\x3ca href\x3d"'+TWP.signin.digital_offer+"tid\x3d"+tidValues.digital+'\x26promo\x3ddigital04_header_default\x26oscode\x3dRPWH\x26wpsrc\x3dCM0000447"\x3eDigital\x3c/a\x3e\x3c/li\x3e'+"\x3c/ul\x3e",1:"\x3cli\x3e"+(provider.indexOf("facebook")>=0?'\x3ca class\x3d"icon share facebook" ':
"\x3ca ")+' href\x3d"'+TWP.signin.profileurl+currentURL+'\x26refresh\x3dtrue"\x3eHi, '+userName+"!\x3c/a\x3e"+"\x3c/li\x3e"+'\x3cli\x3e\x3ca href\x3d"'+TWP.signin.profileurl+currentURL+'\x26refresh\x3dtrue"\x3eMy Account \x3c/a\x3e\x3c/li\x3e'+'\x3cli class\x3d"no-right"\x3e\x3ca href\x3d"'+TWP.signin.logouturl_page+'"\x3eSign Out\x3c/a\x3e\x3c/li\x3e'+'\x3cul class\x3d"subscribe-links left"\x3e'+"\x3c/ul\x3e"},np:{anon:'\x3cli id\x3d"global-signin" style\x3d"min-width:32px;"\x3e'+'\x3ca href\x3d"'+
TWP.signin.loginurl_page+currentURL+'"\x3eSign In\x3c/a\x3e'+"\x3c/li\x3e"+'\x3cli\x3e\x3ca href\x3d"'+TWP.signin.profileurl+currentURL+'\x26refresh\x3dtrue"\x3eMy Account \x3c/a\x3e\x3c/li\x3e'+'\x3cli id\x3d"global-registration" class\x3d"no-right" style\x3d"margin-right:25px;"\x3e'+'\x3ca href\x3d"'+TWP.signin.registrationurl_page+currentURL+'"\x3eRegister\x3c/a\x3e'+"\x3c/li\x3e",signedin:'\x3cli id\x3d"global-signin" style\x3d"min-width:32px;"\x3e'+(provider.indexOf("facebook")>=0?'\x3ca class\x3d"icon share facebook" ':
"\x3cspan\x3eHello \x3c/span\x3e\x3ca ")+' href\x3d"'+TWP.signin.profileurl+currentURL+'\x26refresh\x3dtrue"\x3e'+userName+"\x3c/a\x3e"+"\x3c/li\x3e"+'\x3cli\x3e\x3ca href\x3d"'+TWP.signin.profileurl+currentURL+'\x26refresh\x3dtrue"\x3eMy Account \x3c/a\x3e\x3c/li\x3e'+'\x3cli  id\x3d"global-registration" class\x3d"no-right" style\x3d"margin-right:25px;"\x3e\x3ca href\x3d"'+TWP.signin.logouturl_page+'"\x3eSign Out\x3c/a\x3e\x3c/li\x3e'}};var linkString="";if(TWP.Identity.paywall.pwresp.sub<0)if(TWP.Identity.isSignedIn)linkString=
signinLinks.np.signedin;else linkString=signinLinks.np.anon;else if(TWP.Identity.isSignedIn)linkString=signinLinks.pw[TWP.Identity.paywall.pwresp.sub];else linkString=signinLinks.pw.anon;wrapperElm.find("ul#utility-links.inline-list.left").remove();wrapperElm.prepend('\x3cul id\x3d"utility-links" class\x3d"inline-list left"\x3e'+linkString+"\x3c/ul\x3e")};TWP.Identity.setHandlers=function(){try{$(window.document).on("onTwpLoginComplete",function(event,data){typeof TWP_Debug!="undefined"&&TWP_Debug.pagedebug&&
window.console&&console.log&&console.log(event.type+"fired!");event.stopPropagation();TWP.Util.User.init();TWP.Identity.setAuthenticationLink(data);try{$("body").css("overflow-y","");$("#wp_Signin.simple-overlay").overlay().close()}catch(e){}})}catch(e){}try{$(window.document).on("onTwpMeterReady",function(event){if(TWP.Identity.paywall.pwresp.action===0&&TWP.Identity.paywall.pwresp.fr===1&&wapo_gme!=="1"){$.cookie(gmeCookie,"1",{domain:currDomain,expires:new Date(expireTime),path:"/"});_openOverlay(event,
{pwresp:{action:4,url:TWP.signin.free_access_overlay}})}})}catch(e){}try{$(window.document).on("onTwpWarningFreeAccess",function(event,data){_openOverlay(event,data)})}catch(e){}try{$(window.document).on("onTwpMastheadComplete",function(event){event.stopPropagation();TWP.Identity.setAuthenticationLink()})}catch(e){}try{$(window.document).on("onTwpLoginInit",function(event,data){_openOverlay(event,data)})}catch(e){}TWP.Identity.handlersSet=true};var copyToWindow=function copyToWindow(object){for(var key in object)window[key]=
object[key]};TWP.Identity.auth=function(identityData){var origUrl,origReferrer=document.referrer;if(typeof identityData!="undefined"){origUrl=identityData.url;origReferrer=identityData.referrer}else{origUrl=window.originalWashingtonPostURl&&window.originalWashingtonPostURl.substring(window.originalWashingtonPostURl.indexOf(".com/")+4)||location.pathname;origUrl=origUrl+location.search}if(isPWA&&!!window.history&&!!history.state&&!!history.state.referrer)origReferrer=history.state.referrer;try{document.domain=
currDocDomain;typeof TWP_Debug!="undefined"&&window.console&&console.log&&console.log("["+(new Date-TWP_Debug.initialTime)/1E3+"]"+" STARTING Paywall");window.console&&console.log&&console.log("PAYWALL CHECK STATUS: "+status);window.console&&console.log&&console.log("PWAPI URL: "+TWP.signin.auth_api_url+encodeURI(origUrl+(origUrl.indexOf("?")>=0?"\x26":"?")+"rplapisplit\x3d1\x26referrer\x3d"+origReferrer));var successCallback=function(data){if(data&&data.pwresp){window.console&&console.log&&console.log("PAYWALL ACTION: "+
data.pwresp.action);window.console&&console.log&&console.log("PAYWALL SUB: "+data.pwresp.isSubscriber);window.console&&console.log&&console.log("PAYWALL METERED: "+data.pwresp.data.meterState);window.console&&console.log&&console.log("PAYWALL METER COUNT: "+data.pwresp.data.meterCount);$.extend(TWP.Identity.paywall,eval(data));TWP.Identity.setAuthenticationLink();$(window.document).trigger("onTwpMeterReady");document.dispatchEvent(new CustomEvent("onTwpMeterReady"));$(window.document).trigger("onTwpMeterComplete");
document.dispatchEvent(new CustomEvent("onTwpMeterComplete"))}};var errorCallback=function(responseError){responseError=responseError||{};var errMsg=(responseError.errTextStatusStr?responseError.errTextStatusStr:"")+" "+(responseError.errThrownStr?responseError.errThrownStr:"");TWP.Identity.omniture.tracking.wp_evar53="paywall_"+errMsg||"error";copyToWindow(TWP.Identity.omniture.tracking);$(window.document).trigger("onTwpMeterComplete");document.dispatchEvent(new CustomEvent("onTwpMeterComplete"))};
var registerCallbacks=function(){if(typeof window.registerPwapiConsumer==="function")window.registerPwapiConsumer(function(data){if(data.status!=="init"){TWP.Identity.paywall.pwresp=TWP.Identity.paywall.pwresp||{};if(typeof data=="object")$.extend(TWP.Identity.paywall.pwresp,data);if(data.status=="error")errorCallback(data);else if(data.status=="final"){successCallback({pwresp:data});_openOverlay(null,data)}}});else setTimeout(registerCallbacks,100)};registerCallbacks()}catch(err){$(window.document).trigger("onTwpMeterComplete");
document.dispatchEvent(new CustomEvent("onTwpMeterComplete"))}};TWP.Identity.init=function(){setPerPageVars();if(!TWP.Identity.initComplete&&window.top==window.self){if(!TWP.Identity.handlersSet)TWP.Identity.setHandlers();TWP.Identity.auth();TWP.Identity.initComplete=true}};var loadPaywallIframe=function(overlay,url){var $overlay={};TWP.Identity._loadModalCss();$overlay=$(overlay.overlay);$overlay.jqm(overlay.overlayConfig);$overlay.find("iframe").attr("src",url);$overlay.jqmShow();var perfData=window.performance&&
window.performance.timing||{};window.pwIframeLoaded=(new Date).getTime()-(perfData.navigationStart||0);$(".wp_signin").css("top","60px");TWP&&TWP.Identity&&TWP.Identity.hideMessageArea&&TWP.Identity.hideMessageArea()};var _openOverlay=function(event,data){if(data&&!data.pwresp)data.pwresp=data;typeof TWP_Debug!="undefined"&&TWP_Debug.pagedebug&&window.console&&console.log&&console.log(event.type+"fired!");try{event&&event.stopPropagation()}catch(e){}try{var obj=$.extend({},TWP.Identity.paywall.pwresp,
data.pwresp);if(isPWA)obj.tref="pwa";var params="";$.each(obj,function(i,v){if(i!="url"&&i!="locstor")params=params+"\x26"+i+"\x3d"+v});params=params+(TWP.Data.Tracking&&TWP.Data.Tracking.adblocked!=null&&typeof TWP.Data.Tracking.adblocked!="undefined"?"\x26adb\x3d"+TWP.Data.Tracking.adblocked:"");var baseUrl=_qaEnvironment?"https://subscribe.digitalink.com":"https://www.washingtonpost.com/subscribe";if(window.location.href.indexOf("pb-impact")>=0||window.location.href.indexOf("local.washingtonpost")>=
0||window.location.href.indexOf("vforum-stage")>=0||window.location.href.indexOf("washingtonpost.com/graphics/test/pub")>=0)baseUrl="https://subs-stage.washingtonpost.com";var ol=false;try{ol=TWP&&TWP.Features&&TWP.Features.ol||false}catch(err){}var qs=window.location.search||"";var isComments=qs.match(/.*(outputType=comment|_template=comments-webview)/)!=null;if(data.pwresp.action===0)return;else if(ol===true)return;else if(isComments)return;else if(data.pwresp.action==8)data.pwresp.url=baseUrl+
"/paywall/get-paywall";else if(data.pwresp.action==3)data.pwresp.url=baseUrl+"/paywall/get-paywall";else if(data.pwresp.action==9){if(window.wp_pb&&wp_pb.BrowserInfo&&wp_pb.BrowserInfo.browser=="Explorer"&&wp_pb.BrowserInfo.version<=11)return;data.pwresp.url=baseUrl+"/paywall/get-regwall"}else if(data.pwresp.action==6){if(window.wp_pb&&wp_pb.BrowserInfo&&wp_pb.BrowserInfo.browser=="Explorer"&&wp_pb.BrowserInfo.version<=11)return;data.pwresp.url=baseUrl+"/paywall/get-softwall";if(isMobile&&window.googletag&&
window.googletag.pubadsReady){var adSlots=[];window.googletag.pubads().addEventListener("impressionViewable",function(event){if(!wallClosed){var slotId=event.slot.getSlotElementId();var isBottomAd=slotId==="slug_fixedBottom";var isReEngageAd=slotId==="slug_interstitial";if(event.slot.getSlotElementId()===slotId)adSlots.push(event.slot);if(isBottomAd)window.setTimeout(function(){if(!wallClosed){bottomAdClosed=true;window.googletag.destroySlots(adSlots);adSlots=[];var iframeWindow=document.getElementById("wallIframe");
if(iframeWindow&&iframeWindow.contentWindow)iframeWindow.contentWindow.postMessage("getHeight","*")}},5E3);else if(isReEngageAd&&bottomAdClosed)window.googletag.destroySlots([event.slot])}})}}var pwSection=window.TWP&&window.TWP.Data&&window.TWP.Data.Tracking&&window.TWP.Data.Tracking.props&&window.TWP.Data.Tracking.props.section||window.wp_section;var pwCommercialNode=window.TWP&&window.TWP.Data&&window.TWP.Data.Tracking&&window.TWP.Data.Tracking.props&&window.TWP.Data.Tracking.props.commercial_node||
window.wp_commercial_node;var pwContentType=null;if(window.wp_meta_data&&typeof window.wp_meta_data.contentType==="string")pwContentType=window.wp_meta_data.contentType;else if(window.wp_meta_data&&typeof window.wp_meta_data.contentType==="object"&&window.wp_meta_data.contentType)pwContentType=window.wp_meta_data.contentType[0];else if(window&&window.wp_content_type)pwContentType=window.wp_content_type;var url=data.pwresp.url+(data.pwresp.url.indexOf("?")>=0?"\x26":"?")+encodeURI((pwSection!=="undefined"?
"\x26section\x3d"+pwSection:"")+(pwCommercialNode!=="undefined"?"\x26commercial_node\x3d"+pwCommercialNode:"")+(window&&window.wp_meta_data&&window.wp_meta_data.tags_for_paywall&&typeof window.wp_meta_data.tags_for_paywall!=="undefined"?"\x26ct_tags\x3d"+window.wp_meta_data.tags_for_paywall:"")+(window&&window.wp_meta_data&&window.wp_meta_data.tags_for_paywall_subs&&typeof window.wp_meta_data.tags_for_paywall_subs!=="undefined"?"\x26sct_tags\x3d"+window.wp_meta_data.tags_for_paywall_subs:"")+(pwContentType!==
"undefined"?"\x26content_type\x3d"+pwContentType:"")+(data.pwresp.data&&data.pwresp.data.wallMeterType?"\x26wallMeterType\x3d"+data.pwresp.data.wallMeterType:"")+"\x26destination\x3d"+window.location.href.split("?")[0]+params+(window.wp_meta_data&&window.wp_meta_data.platform&&window.wp_meta_data.platform==="pagebuilder"?"\x26platform\x3dpagebuilder":"")+"\x26caller\x3dclassic");var arcId=((((TWP||{}).Data||{}).Tracking||{}).props||{}).arc_id;var acqEntType=((((TWP||{}).Data||{}).Tracking||{}).props||
{}).content_type;if(arcId)url+="\x26arcId\x3d"+arcId;if(acqEntType)url+="\x26acqEntType\x3dmktg_onsite_"+acqEntType;else url+="\x26acqEntType\x3dmktg_onsite_homepage";window.console&&console.log&&console.log("PAYWALL OVERLAY/REDIRECT URL: "+url);if(data.pwresp.action>=3&&_isOverlayDisplayed(data)===false){window.location.href=url+"\x26acq_test\x3d1";return}var overlay=getOverlay(data.pwresp.action);if(typeof overlay.overlay!=="undefined"&&data.pwresp.action>0){try{typeof window.TWP_Debug!="undefined"&&
TWP_Debug.pagedebug&&window.console&&console.log&&console.log("Regwall: preparing to display overlay");typeof window.TWP_Debug!="undefined"&&TWP_Debug.pagedebug&&window.console&&console.log&&console.log(TWP.Identity.paywall)}catch(e){}var thisAction=data.pwresp.action;if(isMobile&&thisAction===1)thisAction="mobile";if(thisAction===3||thisAction===6||thisAction===8||thisAction===9)loadPaywallIframe(overlay,url)}}catch(e){console.log("error opening paywall overlay/teaser",e)}};var _showLimitedContent=
function(thisAction){if(thisAction&&(thisAction===6||thisAction===9||thisAction==="regwall"||thisAction==="softwall"))return;var $paragraphs=$("article \x3e *");try{var _wordCount=0;$paragraphs.each(function(i,obj){if(obj.tagName=="P"){var wordsRemaining=50-_wordCount;var wordsInSection=obj.innerHTML.split(" ");_wordCount+=wordsInSection.length;if(_wordCount>50){obj.innerHTML=wordsInSection.slice(0,wordsRemaining).join(" ")+"...";$(obj).nextAll().remove();return}}})}catch(ex){$paragraphs.slice(2).remove()}$("#nav-bar").css("transform",
"none");$(".pg-article").css({height:"2000px",overflow:"hidden",position:"relative"});var $pbfarticlearticlebody=$(".pb-f-article-article-body");$pbfarticlearticlebody.nextAll().remove();$("#right-rail \x3e *").not(".pb-f-ad-flex").remove();$("article").append('\x3cp\x3e\x3ca href\x3d"https://subscribe.washingtonpost.com?promo\x3do1_rv"\x3eSubscribe to read the full article\x3c/a\x3e\x3c/p\x3e');window.setTimeout(function(){$pbfarticlearticlebody.nextAll().remove();$("#right-rail \x3e *").not(".pb-f-ad-flex").remove()},
1E3)};var _isOverlayDisplayed=function(){var displayOverlay=true;if(window.wp_pb&&wp_pb.BrowserInfo&&wp_pb.BrowserInfo.browser=="Explorer"&&wp_pb.BrowserInfo.version<=9||$.browser&&$.browser.msie&&$.browser.version<=9)displayOverlay=false;return displayOverlay};var _loadModalCss=function(){if(!TWP.Identity||!TWP.Identity.uswCss){var mysheet=$('style[data-id*\x3d"/modal-css/"],link[href*\x3d"/modal-css/"]');if(mysheet.length===0)try{var head=document.head||document.getElementsByTagName("head")[0],
link=document.createElement("link"),fileName="/pb/resources/css/identity-management/modal-2.0.css"+(window.wp_pb&&window.wp_pb.resourceToken?"?_\x3d"+window.wp_pb.resourceToken:"");link.type="text/css";link.rel="stylesheet";link.href=fileName;head.appendChild(link)}catch(err){}TWP.Identity.uswCss=true}};TWP.Identity._loadModalCss=_loadModalCss;TWP.Identity._openOverlay=_openOverlay;if(!window.wp_pb||!wp_pb.StaticMethods||!wp_pb.StaticMethods.isPageHydrated||wp_pb.StaticMethods.isPageHydrated())TWP.Identity.init();
__e.push(["shamble",function(){TWP.Identity.initComplete=false;TWP.Identity.init()}])})(window.Zepto||window.jQuery);